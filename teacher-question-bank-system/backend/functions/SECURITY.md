# 安全性說明

## 已知依賴套件漏洞

### 1. xlsx (SheetJS)
- **版本**: 0.20.3
- **漏洞數量**: 2個
- **嚴重性**: HIGH
- **說明**: SheetJS 社群版存在已知安全漏洞
- **緩解措施**:
  - 限制上傳檔案大小（已在代碼中實施）
  - 僅允許受信任的用戶上傳 Excel 檔案
  - 對上傳的檔案進行內容驗證
  - 考慮升級到商業版或使用替代方案

### 2. multer
- **版本**: 1.4.5-lts.2
- **漏洞數量**: 2個
- **嚴重性**: HIGH
- **說明**: 文件上傳套件的已知漏洞
- **緩解措施**:
  - 已配置檔案大小限制
  - 已配置允許的檔案類型白名單
  - 文件上傳僅限於已認證用戶
  - 定期檢查更新版本

## 安全最佳實踐

1. **文件上傳**:
   - 限制檔案大小：最大 10MB
   - 僅允許特定檔案類型
   - 使用病毒掃描（建議）
   - 將上傳檔案存儲在隔離環境

2. **認證**:
   - 使用 Firebase Authentication
   - 實施角色型存取控制 (RBAC)
   - 使用 HTTPS 傳輸

3. **資料驗證**:
   - 使用 Joi 進行輸入驗證
   - 實施 CORS 策略
   - 使用 Helmet 增強安全性

## 建議的升級路徑

### 短期（立即執行）
- ✅ 已更新 nodemailer 至 7.0.10
- ✅ 已實施檔案上傳限制
- ✅ 已配置 CORS 和 Helmet

### 中期（未來考慮）
- 評估 xlsx 的替代方案（如 ExcelJS）
- 評估 multer 的替代方案（如 busboy）
- 實施更嚴格的內容安全政策

### 長期（持續維護）
- 定期執行 `npm audit` 檢查
- 訂閱安全性通報
- 保持依賴套件更新

## 風險評估

根據目前的系統使用情境：
- **風險等級**: 中等
- **原因**: 系統僅供內部教育使用，用戶經過認證
- **建議**: 持續監控，並在條件允許時升級套件

## 聯絡資訊

如發現安全問題，請聯絡系統管理員。

