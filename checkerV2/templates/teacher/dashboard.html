<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <title>è‡ªå‹•æ‰¹æ”¹ç³»çµ±æ•™å¸«ç‰ˆ - å„€è¡¨æ¿</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body{font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#f6f7fb;margin:0;padding:24px}
    .wrap{max-width:1200px;margin:0 auto}
    header{background:#fff;border-radius:14px;padding:24px 28px;box-shadow:0 6px 20px rgba(0,0,0,.06);margin-bottom:24px}
    h1{margin:0;font-size:28px;color:#1f2937}
    .subtitle{color:#6b7280;margin:8px 0 0}
    .stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:32px}
    .stat-card{background:#fff;border-radius:14px;padding:24px;box-shadow:0 6px 20px rgba(0,0,0,.06);text-align:center}
    .stat-number{font-size:36px;font-weight:700;color:#4f46e5;margin:0}
    .stat-label{color:#6b7280;margin:8px 0 0;font-size:14px}
    .section{background:#fff;border-radius:14px;padding:24px;box-shadow:0 6px 20px rgba(0,0,0,.06);margin-bottom:24px}
    .section h2{margin:0 0 20px;font-size:20px;color:#1f2937}
    .btn{display:inline-block;background:#4f46e5;color:#fff;border:none;border-radius:10px;padding:12px 20px;cursor:pointer;text-decoration:none;font-size:14px;font-weight:500}
    .btn:hover{background:#4338ca}
    .btn-secondary{background:#6b7280}
    .btn-secondary:hover{background:#4b5563}
    .btn-success{background:#10b981}
    .btn-success:hover{background:#059669}
    .btn-danger{background:#ef4444}
    .btn-danger:hover{background:#dc2626}
    .btn-sm{padding:8px 16px;font-size:12px}
    .exam-list{display:grid;gap:16px}
    .exam-item{background:#f8fafc;border-radius:10px;padding:20px;border-left:4px solid #4f46e5}
    .exam-title{font-size:18px;font-weight:600;color:#1f2937;margin:0 0 8px}
    .exam-meta{color:#6b7280;font-size:14px;margin:0 0 12px}
    .exam-actions{display:flex;gap:8px;flex-wrap:wrap}
    .status{display:inline-block;padding:4px 12px;border-radius:20px;font-size:12px;font-weight:500}
    .status-draft{background:#fef3c7;color:#92400e}
    .status-active{background:#dbeafe;color:#1e40af}
    .status-grading{background:#fce7f3;color:#be185d}
    .status-completed{background:#d1fae5;color:#065f46}
    .empty-state{text-align:center;padding:40px;color:#6b7280}
    .empty-state h3{margin:0 0 8px;color:#374151}
    .empty-state p{margin:0 0 20px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <h1>ğŸ“ è‡ªå‹•æ‰¹æ”¹ç³»çµ±æ•™å¸«ç‰ˆ</h1>
          <p class="subtitle">è€ƒè©¦ç®¡ç†èˆ‡è‡ªå‹•æ‰¹æ”¹ç³»çµ±</p>
        </div>
        <div style="display: flex; gap: 12px;">
          <a href="/" class="btn btn-secondary" style="text-decoration: none;">
            ğŸ”„ åˆ‡æ›åˆ°èˆŠæ‰¹æ”¹é é¢
          </a>
          <a href="/teacher" class="btn" style="text-decoration: none;">
            ğŸ  æ•™å¸«ç‰ˆé¦–é 
          </a>
        </div>
      </div>
    </header>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div style="margin-bottom:24px">
        {% for cat, msg in messages %}
          <div style="padding:12px 16px;background:{% if cat=='error' %}#fef2f2;color:#dc2626;border-left:4px solid #dc2626{% else %}#f0fdf4;color:#16a34a;border-left:4px solid #16a34a{% endif %};border-radius:8px;margin-bottom:8px">
            {{ msg }}
          </div>
        {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <!-- çµ±è¨ˆå¡ç‰‡ -->
    <div class="stats">
      <div class="stat-card">
        <div class="stat-number">{{ total_exams }}</div>
        <div class="stat-label">ç¸½è€ƒè©¦æ•¸</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">{{ active_exams }}</div>
        <div class="stat-label">é€²è¡Œä¸­</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">{{ completed_exams }}</div>
        <div class="stat-label">å·²å®Œæˆ</div>
      </div>
    </div>

    <!-- å¿«é€Ÿæ“ä½œ -->
    <div class="section">
      <h2>å¿«é€Ÿæ“ä½œ</h2>
      <div style="display:flex;gap:12px;flex-wrap:wrap">
        <a href="{{ url_for('create_exam') }}" class="btn">ğŸ“ å‰µå»ºæ–°è€ƒè©¦</a>
        <a href="{{ url_for('exams_list') }}" class="btn btn-secondary">ğŸ“‹ æŸ¥çœ‹æ‰€æœ‰è€ƒè©¦</a>
      </div>
    </div>

    <!-- æœ€è¿‘è€ƒè©¦ -->
    <div class="section">
      <h2>æœ€è¿‘è€ƒè©¦</h2>
      {% if exams %}
        <div class="exam-list">
          {% for exam in exams[:5] %}
            <div class="exam-item">
              <div class="exam-title">{{ exam.title }}</div>
              <div class="exam-meta">
                ç§‘ç›®ï¼š{{ exam.subject }} | 
                å‰µå»ºæ™‚é–“ï¼š{{ exam.created_at.strftime('%Y-%m-%d %H:%M') }} | 
                ç‹€æ…‹ï¼š<span class="status status-{{ exam.status }}">{{ exam.status }}</span>
              </div>
              <div class="exam-actions">
                <a href="{{ url_for('exam_detail', exam_id=exam.exam_id) }}" class="btn btn-sm">æŸ¥çœ‹è©³æƒ…</a>
                {% if exam.status == 'draft' %}
                  <a href="{{ url_for('upload_answers', exam_id=exam.exam_id) }}" class="btn btn-sm btn-success">ä¸Šå‚³ç­”æ¡ˆ</a>
                {% elif exam.status == 'active' %}
                  <a href="{{ url_for('exam_results', exam_id=exam.exam_id) }}" class="btn btn-sm btn-secondary">æŸ¥çœ‹çµæœ</a>
                {% elif exam.status == 'completed' %}
                  <a href="{{ url_for('exam_results', exam_id=exam.exam_id) }}" class="btn btn-sm btn-success">æŸ¥çœ‹çµæœ</a>
                  <a href="{{ url_for('export_results', exam_id=exam.exam_id) }}" class="btn btn-sm btn-secondary">åŒ¯å‡ºExcel</a>
                {% endif %}
              </div>
            </div>
          {% endfor %}
        </div>
        {% if exams|length > 5 %}
          <div style="text-align:center;margin-top:20px">
            <a href="{{ url_for('exams_list') }}" class="btn btn-secondary">æŸ¥çœ‹æ‰€æœ‰è€ƒè©¦</a>
          </div>
        {% endif %}
      {% else %}
        <div class="empty-state">
          <h3>é‚„æ²’æœ‰ä»»ä½•è€ƒè©¦</h3>
          <p>é–‹å§‹å‰µå»ºæ‚¨çš„ç¬¬ä¸€å€‹è€ƒè©¦å§ï¼</p>
          <a href="{{ url_for('create_exam') }}" class="btn">å‰µå»ºè€ƒè©¦</a>
        </div>
      {% endif %}
    </div>
  </div>
</body>
</html>

